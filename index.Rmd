---
title: "Rhode Island Traffic Stops"
output: flexdashboard::flex_dashboard
runtime: shiny
---

```{r global, include=FALSE}
library(flexdashboard)
library(shiny)
library(shinydashboard)
library(shinybootstrap2)
library(ggplot2)

# load data in 'global' chunk so it can be shared by all users of the dashboard
stops <- read.csv("data/police_project.csv")

# Drop the County name
stops$county_name <- NULL

# Remove redundant birth year column
stops$driver_age_raw <- NULL

# Drop the complex categorical columns
stops$violation_raw <- NULL
stops$search_type <- NULL

# Drop all rows (~5000) with missing values
stops <- na.omit(stops)

# Convert the date column to date type
stops$stop_date <- as.Date(stops$stop_date)

# Drop unrecorded gender
stops <- subset(stops, driver_gender != "")
```

Column {.sidebar}
-----------------------------------------------------------------------

Filters

```{r}
selectInput("race", label = "Race:",
            choices = c("All", sort(levels(stops$driver_race))))

#Create a reactive dataset
reactive.stops <- reactive({
  if (input$race != "All"){
    stops[which(stops$driver_race == input$race), ]
  } else {
    stops[,]
  }
})
```

Column
-----------------------------------------------------------------------

### Traffic stops

```{r}
renderPlot({
ggplot(data=reactive.stops(), aes(x=driver_gender))+
geom_bar()
})
```

Column
-----------------------------------------------------------------------

### Arrests

```{r}
renderPlot({
ggplot(data=reactive.stops(), aes(x=is_arrested))+
geom_bar()
})
```

### Stop duration

```{r}
renderPlot({
ggplot(data=reactive.stops(), aes(x=stop_duration))+
geom_bar()
})
```



